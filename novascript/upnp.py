host_ip = ''
host_port = 1900

def fuzzing_main():
    session = Session(target=Target(connection=UDPSocketConnection(host_ip, host_port)), nova_session_param=nova_session_param)
    fuzzing_define_proto(session=session)
    session.fuzz()


def fuzzing_define_proto(session):
    s_initialize(name="upnp")
    with s_block("ssdp"):
        s_bytes(value=bytes([0x4d,0x2d,0x53,0x45,0x41,0x52,0x43,0x48]), size=8, max_len=8, name='http.request.method', fuzzable=False)
        s_bytes(value=bytes([0x20]), size=1, max_len=1, name=' ', fuzzable=False)
        s_bytes(value=bytes([0x2a]), size=1, max_len=1, name='url', fuzzable=True)
        s_bytes(value=bytes([0x48,0x54,0x54,0x50,0x2f,0x31,0x2e,0x31]), size=8, max_len=8, name='version', fuzzable=True)
        s_bytes(value=bytes([0x48,0x4f,0x53,0x54,0x3a,0x20,0x32,0x33,0x39,0x2e,0x32,0x35,0x35,0x2e,0x32,0x35,0x35,0x2e,0x32,0x35,0x30,0x3a,0x31,0x39,0x30,0x30,0x0d,0x0a]), size=28, max_len=28, name='host',fuzzable=True)
        s_bytes(value=bytes([0x4d,0x41,0x4e,0x3a,0x20,0x22,0x73,0x73,0x64,0x70,0x3a,0x64,0x69,0x73,0x63,0x6f,0x76,0x65,0x72,0x22,0x0d,0x0a]), size=22, max_len=22, name='MAN', fuzzable=True)
        s_bytes(value=bytes([0x4d, 0x58,0x3a,0x20,0x35,0x0d,0x0a]), size=7, max_len=7, name='MX', fuzzable=False)
        s_bytes(value=bytes([0x53,0x54,0x3a,0x20,0x75,0x72,0x6e,0x3a,0x73,0x63,0x68,0x65,0x6d,0x61,0x73,0x2d,0x69,
                             0x6e,0x74,0x65,0x6c,0x2d,0x63,0x6f,0x6d,0x3a,0x64,0x65,0x76,0x69,0x63,0x65,0x3a,0x55,
                             0x50,0x6e,0x50,0x50,0x6f,0x77,0x65,0x72,0x4d,0x61,0x6e,0x61,0x67,0x65,0x6d,0x65,0x6e,
                             0x74,0x3a,0x31,0x0d,0x0a]), size=56, max_len=56, name='ST', fuzzable=True)
        s_bytes(value=bytes([0x0d,0x0a]), size=2, max_len=2, name='r.n', fuzzable=False)


    session.connect(s_get('upnp'))


if __name__ == "__main__":
    fuzzing_main()


