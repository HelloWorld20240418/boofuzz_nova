
host_ip = ''
host_port = 1900

def fuzzing_main():
    session = Session(target=Target(connection=UDPSocketConnection(host_ip, host_port)), nova_session_param=nova_session_param)
    fuzzing_define_proto(session=session)
    session.fuzz()


def fuzzing_define_proto(session):
    s_initialize(name="SSDP")
    with s_block("M_SEARCH"):
         s_bytes(value=bytes([0x4d,0x2d,0x53,0x45,0x41,0x52,0x43,0x48]), size=8, max_len=8, name='Requst_Method', fuzzable=False)
         s_bytes(value=bytes([0x20,0x2a]), size=2, max_len=2, name='Requst_uri', fuzzable=False)
         s_bytes(value=bytes([0x20,0x48, 0x54,0x54,0x50,0x2f,0x31,0x2e,0x31]), size=9, max_len=9, name='Requst_version', fuzzable=False)
         s_bytes(value=bytes([0x0a,0x0b,0x48,0x4f,0x53,0x54,0x3a,0x20,0x32,0x33,0x39
                              ,0x2e,0x32,0x35,0x35,0x2e,0x32,0x35,0x35,0x2e,0x32,
                              0x35,0x30,0x3a,0x31,0x39,0x30,0x30,0x30,0x0d,0x0a]),
                 size=28, max_len=28, name='HOST', fuzzable=True)
         s_bytes(value=bytes([0x4d,0x41,0x4e,0x3a,0x20,0x22,0x73,0x73,0x64,0x70,0x3a,0x64,0x69,0x73,0x63,
                             0x6f,0x76,0x65,0x72,0x22,0x0d,0x0a]), size=22, max_len=22, name='MAN', fuzzable=True)
         s_bytes(value=bytes([0x4d,0x58,0x3a,0x20,0x31,0x0d,0x0a]), size=7, max_len=7, name='MX', fuzzable=True)
         s_bytes(value=bytes([0x53,0x54,0x3a,0x20,0x75,0x72,0x6e,0x3a,0x64,0x69,0x61,0x6c,0x2d
                              ,0x6d,0x75,0x6c,0x74,0x69,0x73,0x63,0x72,0x65,0x65,0x6e,0x2d,0x6f,
                              0x72,0x67,0x3a,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x3a,0x64,0x69,0x61,0x6c,0x3a,0x31,0x0d,0x0a]), size=45, max_len=45, name='ST', fuzzable=True)
         s_bytes(value=bytes([0x55,0x53,0x45,0x52,0x2d,0x41,0x47,0x45,0x4e,0x54,0x3a,0x20
                              ,0x4d,0x69,0x63,0x72,0x6f,0x73,0x6f,0x66,0x74,0x20,0x45,0x64,0x67,0x65,
                              0x2f,0x31,0x30,0x33,0x2e,0x30,0x2e,0x31,0x32,0x36,0x34,0x2e,0x34,0x34,0x20
                              ,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x0d,0x0a,0x0d,0x0a]), size=50, max_len=50, name='USER-AGENT', fuzzable=True)

         session.connect(s_get('SSDP'))
if __name__ == "__main__":
    fuzzing_main()