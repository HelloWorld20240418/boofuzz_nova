
host_ip = ''
host_port = 5222

def fuzzing_main():
    session = Session(target=Target(connection=TCPSocketConnection(host_ip, host_port)),nova_session_param=nova_session_param)
    fuzzing_define_proto(session=session)

    session.fuzz()


def fuzzing_define_proto(session):
    s_initialize(name="xmpp")
    with s_block("xmpp"):
        s_bytes(value=bytes([0x3c,0x73,0x74,0x72,0x65,0x61,0x6d,0x3a,0x73,0x74,0x72,0x65,0x61,0x6d,0x20]), size=15, max_len=15, name='header', fuzzable=False)
        s_bytes(value=bytes([0x74,0x6f,0x3d,0x27,0x63,0x73,0x2d,0x78,0x6d,0x70,0x70,0x2e,0x6c,0x61,0x6e,0x27]), size=16, max_len=16, name='xmpp.unknown_attr', fuzzable=False)
        s_bytes(value=bytes([0x20]), size=1, max_len=1, name=' ', fuzzable=False)
        s_bytes(value=bytes([0x78,0x6d,0x6c,0x6e,0x73,0x3d,0x27,0x6a,0x61,0x62,0x62,0x65,0x72,0x3a,0x63,0x6c,0x69,0x65,0x6e,0x74,0x27]), size=21, max_len=21, name='client', fuzzable=True)
        s_bytes(value=bytes([0x20]), size=1, max_len=1, name='  ', fuzzable=False)
        s_bytes(value=bytes([0x78,0x6d,0x6c,0x6e,0x73,0x3a,0x73,0x74,0x72,0x65,0x61,0x6d,0x3d,0x27,0x68,0x74,0x74,0x70,0x3a,0x2f,0x2f,0x65,0x74,0x68,0x65,0x72,0x78,0x2e,0x6a,0x61,0x62,0x62,0x65,0x72,0x2e,0x6f,0x72,0x67,0x2f,0x73,0x74,0x72,0x65,0x61,0x6d,0x73,0x27]), size=47, max_len=47, name='xmpp.xmlns', fuzzable=True)
        s_bytes(value=bytes([0x20]), size=1, max_len=1, name='version', fuzzable=False)
        s_bytes(value=bytes([0x76,0x65,0x72,0x73,0x69,0x6f,0x6e,0x3d,0x27,0x31,0x2e,0x30,0x27]), size=13, max_len=13, name='command2', fuzzable=True)
        s_bytes(value=bytes([0x3e]), size=1, max_len=1, name='end', fuzzable=False)
        session.connect(s_get('xmpp'))


if __name__ == "__main__":
    fuzzing_main()