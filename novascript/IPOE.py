host_ip = ''
host_port = 67


def fuzzing_main():
    session = Session(target=Target(connection=UDPSocketConnection(host_ip, host_port)),nova_session_param=nova_session_param )
    fuzzing_define_proto(session=session)
    session.fuzz()



def fuzzing_define_proto(session):
    s_initialize(name="Discover")
    with s_block("Dynamic_Host_Configuration_Protocol"):
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='Message_type', fuzzable=False)
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='Hardware_type1', fuzzable=False)
        s_bytes(value=bytes([0x06]), size=1, max_len=1, name='Hardware_address_type', fuzzable=False)
        s_bytes(value=bytes([0x00]), size=1, max_len=1, name='Hops', fuzzable=False)
        s_bytes(value=bytes([0xae,0xa9,0xac,0x7c]), size=4, max_len=4, name='Transaction_ID', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00]), size=2, max_len=2, name='Seconds_elapsed', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00]), size=2, max_len=2, name='Bootp_flags', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Client_IP_address', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Your_IP_address', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Next_server_IP_address', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Relay_agent_IP_address', fuzzable=False)
        s_bytes(value=bytes([0xa2, 0x01, 0xfb, 0x49,0x83,0x72]), size=6, max_len=6, name='Client_MAC_address1', fuzzable=True)
        s_bytes(value=bytes([0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00,0x00,0x00]), size=10, max_len=10, name='Client_hardware_address_padding',fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                 0x00,0x00,0x00,0x00
                                 ]), size=64, max_len=64,name='Sever_host_name_not_given', fuzzable=True)
        s_bytes(value=bytes(
                [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00
                 ]), size=128, max_len=128, name='Boot_file_name_not_given', fuzzable=True)
        s_bytes(value=bytes([0x63,0x82,0x53,0x63]), size=4, max_len=4, name='Magic_cookie', fuzzable=False)
        s_bytes(value=bytes([0x35]), size=1, max_len=1, name='option1', fuzzable=False)
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='Length1', fuzzable=False)
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='DHCP', fuzzable=False)
        s_bytes(value=bytes([0x3d]), size=1, max_len=1, name='option2', fuzzable=False)
        s_bytes(value=bytes([0x07]), size=1, max_len=1, name='Length2', fuzzable=False)
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='Hardware_type', fuzzable=False)
        s_bytes(value=bytes([0xa2, 0x01, 0xfb, 0x49,0x83,0x72]), size=6, max_len=6, name='Client_MAC_address', fuzzable=False)
        s_bytes(value=bytes([0x0c]), size=1, max_len=1, name='option3', fuzzable=False)
        s_bytes(value=bytes([0x06]), size=1, max_len=1, name='Length3', fuzzable=False)
        s_bytes(value=bytes([0x63, 0x6c, 0x69, 0x65,0x6e,0x74]), size=6, max_len=6, name='Host_name',fuzzable=False)
        s_bytes(value=bytes([0xff]), size=1, max_len=1, name='option4', fuzzable=False)
        s_bytes(value=bytes(
                [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00]), size=46, max_len=46, name='padding', fuzzable=True)
    s_initialize(name="Requst")
    with s_block("Dynamic_Host_Configuration_Protocol"):
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='Message_type', fuzzable=False)
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='Hardware_type1', fuzzable=False)
        s_bytes(value=bytes([0x06]), size=1, max_len=1, name='Hardware_address_type', fuzzable=False)
        s_bytes(value=bytes([0x00]), size=1, max_len=1, name='Hops', fuzzable=False)
        s_bytes(value=bytes([0xae,0xa9,0xac,0x7c]), size=4, max_len=4, name='Transaction_ID', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00]), size=2, max_len=2, name='Seconds_elapsed', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00]), size=2, max_len=2, name='Bootp_flags', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Client_IP_address', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Your_IP_address', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Next_server_IP_address', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00]), size=4, max_len=4, name='Relay_agent_IP_address', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00, 0x00, 0x00, 0x00, 0x00]), size=6, max_len=6, name='Client_hardware_address_padding',fuzzable=False)
        s_bytes(value=bytes([0x00, 0x0b, 0x82, 0x01,0xfc,0x42,0x00,0x00,0x00,0x00]), size=10, max_len=10, name='Client_MAC_address1', fuzzable=True)
        s_bytes(value=bytes([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                 0x00,0x00,0x00,0x00
                                 ]), size=64, max_len=64,name='Sever_host_name_not_given', fuzzable=True)
        s_bytes(value=bytes(
                [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00,
                 0x00, 0x00, 0x00, 0x00
                 ]), size=128, max_len=128, name='Boot_file_name_not_given', fuzzable=True)
        s_bytes(value=bytes([0x63,0x82,0x53,0x63]), size=4, max_len=4, name='Magic_cookie', fuzzable=False)
        s_bytes(value=bytes([0x35]), size=1, max_len=1, name='option1', fuzzable=False)
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='Length1', fuzzable=False)
        s_bytes(value=bytes([0x03]), size=1, max_len=1, name='DHCP', fuzzable=False)
        s_bytes(value=bytes([0x32]), size=1, max_len=1, name='option3', fuzzable=False)
        s_bytes(value=bytes([0x04]), size=1, max_len=1, name='Length3', fuzzable=False)
        s_bytes(value=bytes([0xc0, 0xa8, 0x00, 0x0a]), size=4, max_len=4, name='Requsted_IP_address',fuzzable=False)
        s_bytes(value=bytes([0x36]), size=1, max_len=1, name='option4', fuzzable=False)
        s_bytes(value=bytes([0x04]), size=1, max_len=1, name='Length4', fuzzable=False)
        s_bytes(value=bytes([0xc0,0xa8,0x00,0x01]), size=4, max_len=4, name='DHCP_Server_identifer', fuzzable=False)
        s_bytes(value=bytes([0x0c]), size=1, max_len=1, name='parameter_request_list', fuzzable=False)
        s_bytes(value=bytes([0x06]), size=1, max_len=1, name='Length5', fuzzable=False)
        s_bytes(value=bytes([0x63, 0x6c, 0x69, 0x65,0x6e,0x74]), size=6, max_len=6, name='Host_name',fuzzable=False)
        s_bytes(value=bytes([0xff]), size=1, max_len=1, name='option_end', fuzzable=False)
        s_bytes(value=bytes(
            [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
             0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
             0x00, 0x00, 0x00,0x00]), size=43, max_len=43, name='padding', fuzzable=True)

        session.connect(s_get('Requst'))

        # session.connect(s_get('Discover'))
        # session.connect(s_get('Discover'),s_get('Requst'))
if __name__ == "__main__":
            fuzzing_main()








