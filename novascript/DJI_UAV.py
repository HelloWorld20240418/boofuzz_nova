

host_ip = ''
host_port = 4242

def fuzzing_main():
    session = Session(target=Target(connection=TCPSocketConnection(host_ip, host_port)),nova_session_param=nova_session_param)

    fuzzing_define_proto(session=session)

    session.fuzz()


def fuzzing_define_proto(session):
    s_initialize(name="DICOM")
    with s_block("DICOM"):
        s_bytes(value=bytes([0x01]), size=1, max_len=1, name='PDU_YTPE', fuzzable=True)
        s_bytes(value=bytes([0x00]), size=1, max_len=1, name='header', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00,0x00,0xcd]), size=4, max_len=4, name='PDU_LENGTH', fuzzable=False)
        s_bytes(value=bytes([0x00,0x01]), size=4, max_len=4, name='protocol_version', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00]), size=2, max_len=2, name='header_2', fuzzable=False)
        s_bytes(value=bytes([0x41,0x4e,0x59,0x2d,0x53,0x43,0x50,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20]), size=16, max_len=16, name='dicom.assoc.ae.called', fuzzable=False)
        s_bytes(value=bytes([0x45,0x43,0x48,0x4f,0x53,0x43,0x55,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20]), size=16, max_len=16, name='dicom.assoc.ae.called2', fuzzable=False)
        s_bytes(value=bytes([0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]), size=32, max_len=32, name='haer_3', fuzzable=False)
        s_bytes(value=bytes([0x10, 0x00, 0x00, 0x15, 0x31, 0x2e, 0x32, 0x2e, 0x38, 0x34, 0x30, 0x2e, 0x31, 0x30, 0x30, 0x30, 0x38, 0x2e, 0x33, 0x2e, 0x31, 0x2e, 0x31, 0x2e, 0x31]), size=25, max_len=25, name='APPlication_context', fuzzable=True)
        s_bytes(value=bytes([0x20,0x00,0x00,0x2e,0x01,0x00,0xff,0x00,0x30,0x00,0x00,0x11,0x31,0x2e,0x32,0x2e,0x38,0x34,0x30,0x2e,0x31,0x30,0x30,0x30,0x38,0x2e,0x31,0x2e,0x31,0x40,0x00,0x00,0x11,0x31,0x2e,0x32,0x2e,0x38,0x34,0x30,0x2e,0x31,0x30,0x30,0x30,0x38,0x2e,0x31,0x2e,0x32]), size=50, max_len=50, name='APPlication_context2', fuzzable=True)
        s_bytes(value=bytes([0x50]), size=1, max_len=1, name='item_type', fuzzable=False)
        s_bytes(value=bytes([0x00]), size=1, max_len=1, name='header_3', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x3a]), size=2, max_len=2, name='item_length', fuzzable=False)
        s_bytes(value=bytes([0x51, 0x00,0x00,0x04,0x00,0x00,0x40,0x00]), size=8, max_len=8, name='MAX_pdu_length', fuzzable=False)
        s_bytes(value=bytes([0x52]), size=1, max_len=1, name='item_type2', fuzzable=False)
        s_bytes(value=bytes([0x00]), size=1, max_len=1, name='header_4', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x1b]), size=2, max_len=2, name='item_length1', fuzzable=False)
        s_bytes(value=bytes([0x31,0x2e,0x32,0x2e,0x32,0x37,0x36,0x2e,0x30,0x2e,0x37,0x32,0x33,0x30,0x30,0x31,0x30,0x2e,0x33,0x2e,0x30,0x2e,0x33,0x2e,0x36,0x2e,0x32]), size=27, max_len=27, name='uid', fuzzable=True)
        s_bytes(value=bytes([0x55]), size=1, max_len=1, name='item_type3', fuzzable=False)
        s_bytes(value=bytes([0x00]), size=1, max_len=1, name='header_5', fuzzable=False)
        s_bytes(value=bytes([0x00, 0x0f]), size=2, max_len=2, name='item_length2', fuzzable=False)
        s_bytes(value=bytes([0x4f,0x46,0x46,0x49,0x53,0x5f,0x44,0x43,0x4d,0x54,0x4b,0x5f,0x33,0x36,0x32]), size=27, max_len=27, name='implementation_version', fuzzable=False)



        session.connect(s_get('DICOM'))


if __name__ == "__main__":
    fuzzing_main()